var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.Progress = void 0;
var Component_1 = require("../component/Component");
var Text_1 = require("../component/Text");
var Rect_1 = require("../component/Rect");
var Ani_1 = require("./Ani");
var AniCreator_1 = require("./AniCreator");
var Constant_1 = require("../Constant");
var d3_1 = require("d3");
var Progress = /** @class */ (function (_super) {
    __extends(Progress, _super);
    function Progress(options) {
        var _a, _b, _c, _d;
        var _this = _super.call(this) || this;
        _this.radius = 6;
        _this.padding = 3;
        _this.lineWidth = 2;
        _this.center = { x: 0, y: 0 };
        if (options) {
            _this.position = (_a = options.position) !== null && _a !== void 0 ? _a : { x: 0, y: 0 };
            _this.aniTime = (_b = options.aniTime) !== null && _b !== void 0 ? _b : [0, 3];
            _this.shape = (_c = options.shape) !== null && _c !== void 0 ? _c : { width: 400, height: 18 };
            _this.color = (_d = options.color) !== null && _d !== void 0 ? _d : "#FFF";
        }
        var border0 = new Rect_1.Rect({
            shape: {
                width: _this.shape.width,
                height: _this.shape.height,
            },
            center: { x: _this.shape.width / 2, y: _this.shape.height / 2 },
            alpha: 1,
            radius: _this.radius,
            fillStyle: "#0006",
            strokeStyle: _this.color,
            lineWidth: _this.lineWidth,
        });
        var border1 = new Rect_1.Rect({
            shape: {
                width: _this.shape.width * 1.75,
                height: _this.shape.height,
            },
            center: {
                x: (_this.shape.width * 1.75) / 2,
                y: _this.shape.height / 2,
            },
            alpha: 1,
            radius: _this.radius,
            fillStyle: "#0006",
            strokeStyle: _this.color,
            lineWidth: _this.lineWidth,
        });
        var bar0 = new Rect_1.Rect({
            position: { x: _this.padding, y: _this.padding },
            center: { x: _this.shape.width / 2, y: _this.shape.height / 2 },
            shape: { width: 0, height: _this.shape.height - _this.padding * 2 },
            radius: _this.radius,
            fillStyle: _this.color,
        });
        var bar1 = new Rect_1.Rect({
            position: { x: _this.padding, y: _this.padding },
            center: { x: (_this.shape.width / 2) * 1.75, y: _this.shape.height / 2 },
            shape: {
                width: (_this.shape.width - _this.padding * 2) * 1.75,
                height: _this.shape.height - _this.padding * 2,
            },
            radius: _this.radius,
            fillStyle: _this.color,
        });
        var start = new Component_1.Component({
            position: _this.position,
            scale: { x: 2, y: 2 },
        });
        start.children.push(border0);
        start.children.push(bar0);
        var end = new Component_1.Component({
            position: _this.position,
            scale: { x: 1, y: 1 },
        });
        end.children.push(border1);
        end.children.push(bar1);
        var borderFinished = new Rect_1.Rect({
            shape: {
                width: _this.shape.width * 2,
                height: _this.shape.height * 2,
            },
            center: {
                x: (_this.shape.width * 2) / 2,
                y: (_this.shape.height * 2) / 2,
            },
            alpha: 0,
            radius: _this.radius,
            fillStyle: "#0006",
            strokeStyle: "#27C",
            lineWidth: _this.lineWidth,
        });
        var bar2 = new Rect_1.Rect({
            center: { x: _this.shape.width / 2, y: _this.shape.height / 2 },
            position: { x: _this.padding, y: _this.padding },
            shape: {
                width: _this.shape.width - _this.padding * 2,
                height: _this.shape.height - _this.padding * 2,
            },
            alpha: 0.0,
            radius: _this.radius,
            fillStyle: "#27C",
        });
        var final = new Component_1.Component({
            position: _this.position,
            alpha: 1,
            scale: { x: 1.2, y: 1.2 },
        });
        final.children.push(borderFinished);
        final.children.push(bar2);
        var objCopy = Object.assign({}, final);
        objCopy.alpha = 0;
        _this.ani = AniCreator_1.customAni(_this.aniTime[0])
            .keyFrame(start)
            .duration(_this.aniTime[1], d3_1.easePolyOut.exponent(5))
            .keyFrame(end)
            .duration(0.25, d3_1.easeExpOut)
            .keyFrame(final)
            .duration(0.5)
            .keyFrame(final)
            .duration(0.2)
            .keyFrame(objCopy);
        return _this;
    }
    Progress.prototype.getComponent = function (sec) {
        var val = d3_1.scaleLinear(this.aniTime, [0, 100])
            .clamp(true)
            .interpolate(AniCreator_1.easeInterpolate(d3_1.easePolyOut.exponent(5)))(sec);
        var label = d3_1.format("d")(val);
        var res = this.ani.getComponent(sec);
        var textLabel = new Text_1.Text({
            text: val === 100 ? "" : "Loading " + label + " %",
            font: Constant_1.font,
            fontSize: 24,
            textAlign: "center",
            textBaseline: "top",
            position: { x: 0, y: this.shape.height },
            fillStyle: "#fff",
        });
        res === null || res === void 0 ? void 0 : res.children.push(textLabel);
        return res;
    };
    return Progress;
}(Ani_1.Ani));
exports.Progress = Progress;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUHJvZ3Jlc3MuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29yZS9hbmkvUHJvZ3Jlc3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsb0RBQW1EO0FBQ25ELDBDQUF5QztBQUN6QywwQ0FBeUM7QUFDekMsNkJBQTRCO0FBQzVCLDJDQUEwRDtBQUMxRCx3Q0FBbUM7QUFDbkMseUJBQWtFO0FBT2xFO0lBQThCLDRCQUFHO0lBVS9CLGtCQUFZLE9BQXlCOztRQUFyQyxZQUNFLGlCQUFPLFNBK0dSO1FBdkhELFlBQU0sR0FBVyxDQUFDLENBQUM7UUFDbkIsYUFBTyxHQUFXLENBQUMsQ0FBQztRQUNwQixlQUFTLEdBQVcsQ0FBQyxDQUFDO1FBR3RCLFlBQU0sR0FBRyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1FBSXRCLElBQUksT0FBTyxFQUFFO1lBQ1gsS0FBSSxDQUFDLFFBQVEsU0FBRyxPQUFPLENBQUMsUUFBUSxtQ0FBSSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDO1lBQ25ELEtBQUksQ0FBQyxPQUFPLFNBQUcsT0FBTyxDQUFDLE9BQU8sbUNBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7WUFDekMsS0FBSSxDQUFDLEtBQUssU0FBRyxPQUFPLENBQUMsS0FBSyxtQ0FBSSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFFLEVBQUUsRUFBRSxDQUFDO1lBQ3pELEtBQUksQ0FBQyxLQUFLLFNBQUcsT0FBTyxDQUFDLEtBQUssbUNBQUksTUFBTSxDQUFDO1NBQ3RDO1FBQ0QsSUFBTSxPQUFPLEdBQUcsSUFBSSxXQUFJLENBQUM7WUFDdkIsS0FBSyxFQUFFO2dCQUNMLEtBQUssRUFBRSxLQUFJLENBQUMsS0FBSyxDQUFDLEtBQUs7Z0JBQ3ZCLE1BQU0sRUFBRSxLQUFJLENB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