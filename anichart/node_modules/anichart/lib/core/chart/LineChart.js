var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.LineChart = void 0;
var CanvasHelper_1 = require("../CanvasHelper");
var ColorPicker_1 = require("../ColorPicker");
var Arc_1 = require("../component/Arc");
var Component_1 = require("../component/Component");
var Path_1 = require("../component/Path");
var Rect_1 = require("../component/Rect");
var Text_1 = require("../component/Text");
var BaseChart_1 = require("./BaseChart");
var Constant_1 = require("../Constant");
var d3_1 = require("d3");
var LineChart = /** @class */ (function (_super) {
    __extends(LineChart, _super);
    function LineChart(options) {
        var _a;
        var _this = _super.call(this, options) || this;
        _this.labelPlaceholder = 0;
        _this.labelSize = 32;
        _this.labelPadding = 4;
        _this.topN = 5;
        if (!options)
            return _this;
        _this.pointerR = (_a = options.pointerR) !== null && _a !== void 0 ? _a : 10;
        return _this;
    }
    LineChart.prototype.setup = function (stage) {
        var _this = this;
        var _a;
        _super.prototype.setup.call(this, stage);
        this.xTickFormat = function (n) {
            return d3_1.timeFormat("%Y-%m-%d")(_this.secToDate(n));
        };
        // Calculate label placeholder
        var textModel = new Text_1.Text({
            fontSize: this.labelSize,
            font: Constant_1.font,
        });
        var labelMaxWidth = (_a = d3_1.max(this.data, function (d) {
            var _a, _b;
            textModel.text = _this.labelFormat(d[_this.idField], _this.meta, d);
            return (_b = (_a = CanvasHelper_1.canvasHelper.measure(textModel)) === null || _a === void 0 ? void 0 : _a.width) !== null && _b !== void 0 ? _b : 0;
        })) !== null && _a !== void 0 ? _a : 0;
        this.labelPlaceholder = labelMaxWidth;
    };
    LineChart.prototype.getComponent = function (sec) {
        var _this = this;
        var res = new Component_1.Component({
            position: this.position,
            alpha: this.alphaScale(sec - this.fadeTime[0] - this.freezeTime[0]),
        });
        if (this.aniTime[0] > sec)
            return null;
        this.scales = this.getScalesBySec(sec);
        var _a = this.getAxis(sec, this.scales), xAxis = _a.xAxis, yAxis = _a.yAxis;
        var lineGen = d3_1.line()
            .defined(function (d) { return !isNaN(d[_this.valueField]); })
            .x(function (d) { return _this.scales.x(_this.secToDate.invert(d[_this.dateField])); })
            .y(function (d) { return _this.scales.y(d[_this.valueField]); });
        var areaGen = d3_1.area()
            .defined(function (d) { return !isNaN(d[_this.valueField]); })
            .x(function (d) { return _this.scales.x(_this.secToDate.invert(d[_this.dateField])); })
            .y0(this.shape.height)
            .y1(function (d) { return _this.scales.y(d[_this.valueField]); });
        var lineArea = new Rect_1.Rect({
            clip: true,
            position: {
                x: this.margin.left + this.yAxisWidth + this.xAxisPadding,
                y: this.margin.top + this.xAxisHeight + this.yAxisPadding,
            },
            shape: {
                width: this.shape.width -
                    this.margin.left -
                    this.margin.right -
                    this.yAxisWidth -
                    this.yAxisPadding -
                    this.labelPlaceholder -
                    this.labelPadding -
                    this.pointerR,
                height: this.shape.height -
                    this.margin.top -
                    this.margin.bottom -
                    this.xAxisHeight -
                    this.xAxisPadding,
            },
            fillStyle: "#0000",
        });
        var points = new Component_1.Component({
            position: {
                x: this.margin.left + this.yAxisWidth + this.yAxisPadding,
                y: this.margin.top + this.xAxisHeight + this.xAxisPadding,
            },
        });
        var labels = new Component_1.Component({
            position: {
                x: this.margin.left + this.yAxisWidth + this.yAxisPadding,
                y: this.margin.top + this.xAxisHeight + this.xAxisPadding,
            },
        });
        var maxX = d3_1.max(this.scales.x.range());
        // 找不到最大值说明啥数据都没有，直接返回
        if (!maxX)
            return res;
        this.dataGroupByID.forEach(function (v, k) {
            var line = new Path_1.Path();
            var color = ColorPicker_1.colorPicker.getColor(k);
            line.strokeStyle = color;
            line.path = lineGen.curve(d3_1.curveMonotoneX)(v);
            line.lineWidth = 3;
            lineArea.children.push(line);
            var areaPath = areaGen.curve(d3_1.curveMonotoneX)(v);
            // 如果画不出Path直接返回
            if (!areaPath)
                return;
            var currentY = _this.findY(areaPath, maxX);
            var point = new Arc_1.Arc({
                fillStyle: color,
                radius: _this.pointerR,
                alpha: currentY !== undefined ? 1 : 0,
                position: { x: maxX, y: currentY },
            });
            var maxValue = _this.scales.y.invert(currentY);
            if (maxValue > _this.historyMax) {
                _this.historyMax = maxValue;
            }
            else if (maxValue < _this.historyMin) {
                _this.historyMin = maxValue;
            }
            points.children.push(point);
            var data = new Map();
            data.set(_this.valueField, maxValue);
            var label = new Text_1.Text({
                text: _this.labelFormat(k, _this.meta, data),
                fontSize: _this.labelSize,
                font: Constant_1.font,
                textAlign: "left",
                textBaseline: "middle",
                position: { x: maxX + _this.labelPadding + _this.pointerR, y: currentY },
                fillStyle: color,
            });
            labels.children.push(label);
        });
        res.children.push(lineArea);
        res.children.push(points);
        res.children.push(xAxis);
        res.children.push(yAxis);
        res.children.push(labels);
        return res;
    };
    LineChart.prototype.getScalesBySec = function (sec) {
        var _this = this;
        var currentData = this.getCurrentData(sec);
        var valueRange = d3_1.extent(currentData, function (d) { return d[_this.valueField]; });
        if (valueRange[0] == undefined) {
            valueRange = [0, 0];
        }
        if (this.historyMax > valueRange[1]) {
            valueRange[1] = this.historyMax;
        }
        if (this.historyMin < valueRange[0]) {
            valueRange[0] = this.historyMin;
        }
        var delta = (valueRange[1] - valueRange[0]) * 0.1;
        valueRange[0] -= delta;
        valueRange[1] += delta;
        var trueSec = sec < this.aniTime[0]
            ? this.aniTime[0]
            : sec > this.aniTime[1]
                ? this.aniTime[1]
                : sec;
        var scales = {
            x: d3_1.scaleLinear([this.aniTime[0], trueSec], [
                0,
                this.shape.width -
                    this.margin.left -
                    this.margin.right -
                    this.yAxisWidth -
                    this.yAxisPadding -
                    this.labelPlaceholder -
                    this.labelPadding -
                    this.pointerR,
            ]),
            y: d3_1.scaleLinear(valueRange, [
                this.shape.height -
                    this.margin.top -
                    this.margin.bottom -
                    this.xAxisHeight,
                this.xAxisPadding,
            ]),
        };
        return scales;
    };
    LineChart.prototype.findY = function (area, x) {
        var l = 0;
        var r = this.shape.height;
        // 9w => 4k
        // 使用中值优化，提升>22倍的性能
        var b = d3_1.bisector(function (d) {
            return CanvasHelper_1.canvasHelper.isPointInPath(area, x, d);
        }).left;
        var yRange = d3_1.range(l, r, 1);
        var index = b(yRange, true);
        return yRange[index];
    };
    return LineChart;
}(BaseChart_1.BaseChart));
exports.LineChart = LineChart;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiTGluZUNoYXJ0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvcmUvY2hhcnQvTGluZUNoYXJ0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLGdEQUErQztBQUMvQyw4Q0FBNkM7QUFDN0Msd0NBQXVDO0FBQ3ZDLG9EQUFtRDtBQUNuRCwwQ0FBeUM7QUFDekMsMENBQXlDO0FBQ3pDLDBDQUF5QztBQUV6Qyx5Q0FBMEQ7QUFDMUQsd0NBQW1DO0FBQ25DLHlCQVdZO0FBSVo7SUFBK0IsNkJBQVM7SUFNdEMsbUJBQVksT0FBeUI7O1FBQXJDLFlBQ0Usa0JBQU0sT0FBTyxDQUFDLFNBR2Y7UUFSRCxzQkFBZ0IsR0FBVyxDQUFDLENBQUM7UUFDN0IsZUFBUyxHQUFXLEVBQUUsQ0FBQztRQUN2QixrQkFBWSxHQUFXLENBQUMsQ0FBQztRQUN6QixVQUFJLEdBQVcsQ0FBQyxDQUFDO1FBR2YsSUFBSSxDQUFDLE9BQU87eUJBQVM7UUFDckIsS0FBSSxDQUFDLFFBQVEsU0FBRyxPQUFPLENBQUMsUUFBUSxtQ0FBSSxFQUFFLENBQUM7O0lBQ3pDLENBQUM7SUFLRCx5QkFBSyxHQUFMLFVBQU0sS0FBWTtRQUFsQixpQkFnQkM7O1FBZkMsaUJBQU0sS0FBSyxZQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25CLElBQUksQ0FBQyxXQUFXLEdBQUcsVUFBQyxDQUFpQztZQUNuRCxPQUFPLGVBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQyxLQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkQsQ0FBQyxDQUFDO1FBQ0YsOEJBQThCO1FBQzlCLElBQU0sU0FBUyxHQUFHLElBQUksV0FBSSxDQUFDO1lBQ3pCLFFBQVEsRUFBRSxJQUFJLENBQUMsU0FBUztZQUN4QixJQUFJLGlCQUFBO1NBQ0wsQ0FBQyxDQUFDO1FBQ0gsSUFBTSxhQUFhLFNBQ2pCLFFBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxF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