Object.defineProperty(exports, "__esModule", { value: true });
exports.Recorder = void 0;
var Recorder = /** @class */ (function () {
    function Recorder() {
    }
    Recorder.prototype.record = function (canvas, time) {
        var recordedChunks = [];
        return new Promise(function (res, _) {
            var stream = canvas.captureStream(60 /*fps*/);
            var mediaRecorder = new MediaRecorder(stream, {
                mimeType: "video/webm; codecs=vp9",
            });
            // on data available will fire in interval of `time || 4000 ms`
            mediaRecorder.start(time || 4000);
            mediaRecorder.onDataAvailable = function (e) {
                recordedChunks.push(e.data);
                if (mediaRecorder.state === "recording") {
                    // after stop data available event run one more time
                    mediaRecorder.stop();
                }
            };
            mediaRecorder.onstop = function (event) {
                var blob = new Blob(recordedChunks, {
                    type: "video/webm",
                });
                var url = URL.createObjectURL(blob);
                res(url);
            };
        });
    };
    return Recorder;
}());
exports.Recorder = Recorder;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVjb3JkZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29yZS9SZWNvcmRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBO0lBQUE7SUE2QkEsQ0FBQztJQTVCQyx5QkFBTSxHQUFOLFVBQU8sTUFBVyxFQUFFLElBQVk7UUFDOUIsSUFBTSxjQUFjLEdBQUcsRUFBVyxDQUFDO1FBQ25DLE9BQU8sSUFBSSxPQUFPLENBQUMsVUFBQyxHQUFHLEVBQUUsQ0FBQztZQUN4QixJQUFNLE1BQU0sR0FBRyxNQUFNLENBQUMsYUFBYSxDQUFDLEVBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUNoRCxJQUFNLGFBQWEsR0FBRyxJQUFJLGFBQWEsQ0FBQyxNQUFNLEVBQUU7Z0JBQzlDLFFBQVEsRUFBRSx3QkFBd0I7YUFDbkMsQ0FBQyxDQUFDO1lBRUgsK0RBQStEO1lBQy9ELGFBQWEsQ0FBQyxLQUFLLENBQUMsSUFBSSxJQUFJLElBQUksQ0FBQyxDQUFDO1lBRWxDLGFBQWEsQ0FBQyxlQUFlLEdBQUcsVUFBQyxDQUFNO2dCQUNyQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDNUIsSUFBSSxhQUFhLENBQUMsS0FBSyxLQUFLLFdBQVcsRUFBRTtvQkFDdkMsb0RBQW9EO29CQUNwRCxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUM7aUJBQ3RCO1lBQ0gsQ0FBQyxDQUFDO1lBRUYsYUFBYSxDQUFDLE1BQU0sR0FBRyxVQUFDLEtBQVU7Z0JBQ2hDLElBQU0sSUFBSSxHQUFHLElBQUksSUFBSSxDQUFDLGNBQWMsRUFBRTtvQkFDcEMsSUFBSSxFQUFFLFlBQVk7aUJBQ25CLENBQUMsQ0FBQztnQkFDSCxJQUFNLEdBQUcsR0FBRyxHQUFHLENBQUMsZUFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO2dCQUN0QyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDWCxDQUFDLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFDSCxlQUFDO0FBQUQsQ0FBQyxBQTdCRCxJQTZCQztBQTdCWSw0QkFBUSJ9