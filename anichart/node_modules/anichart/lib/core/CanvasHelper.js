Object.defineProperty(exports, "__esModule", { value: true });
exports.canvasHelper = exports.CanvasHelper = void 0;
var canvas_1 = require("canvas");
var CanvasRenderer_1 = require("./CanvasRenderer");
var CanvasHelper = /** @class */ (function () {
    function CanvasHelper() {
        this.renderer = CanvasRenderer_1.canvasRenderer;
        if (typeof window == "undefined") {
            // node
            var nodeCanvas = canvas_1.createCanvas(1920, 1080);
            this.renderer.canvas = nodeCanvas;
            this.renderer.ctx = nodeCanvas.getContext("2d");
        }
        else {
            // browser
            var canvas = document.querySelector("canvas");
            if (!canvas) {
                canvas = document.createElement("canvas");
            }
            this.renderer.canvas = canvas;
            this.renderer.ctx = canvas.getContext("2d");
        }
    }
    CanvasHelper.prototype.isPointInPath = function (area, x, d) {
        var _a;
        if (typeof area == "string") {
            area = new Path2D(area);
        }
        return (_a = this.renderer.ctx) === null || _a === void 0 ? void 0 : _a.isPointInPath(area, x, d);
    };
    CanvasHelper.prototype.measure = function (c) {
        this.renderer.ctx.save();
        if (c.type === "Text") {
            return this.measureText(c);
        }
        this.renderer.ctx.restore();
        return { width: 0 };
    };
    CanvasHelper.prototype.measureText = function (c) {
        var _a;
        this.renderer.prerenderText(c);
        var res = this.renderer.ctx.measureText((_a = c.text) !== null && _a !== void 0 ? _a : "");
        this.renderer.ctx.restore();
        return res;
    };
    return CanvasHelper;
}());
exports.CanvasHelper = CanvasHelper;
exports.canvasHelper = new CanvasHelper();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FudmFzSGVscGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2NvcmUvQ2FudmFzSGVscGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsaUNBQXNDO0FBQ3RDLG1EQUFrRTtBQUdsRTtJQVFFO1FBREEsYUFBUSxHQUFtQiwrQkFBYyxDQUFDO1FBRXhDLElBQUksT0FBTyxNQUFNLElBQUksV0FBVyxFQUFFO1lBQ2hDLE9BQU87WUFDUCxJQUFJLFVBQVUsR0FBRyxxQkFBWSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztZQUMxQyxJQUFJLENBQUMsUUFBUSxDQUFDLE1BQU0sR0FBRyxVQUFVLENBQUM7WUFDbEMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLEdBQUcsVUFBVSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUNqRDthQUFNO1lBQ0wsVUFBVTtZQUNWLElBQUksTUFBTSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7WUFDOUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtnQkFDWCxNQUFNLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsQ0FBQzthQUMzQztZQUNELElBQUksQ0FBQyxRQUFRLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztZQUM5QixJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsR0FBRyxNQUFNLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBRSxDQUFDO1NBQzlDO0lBQ0gsQ0FBQztJQXRCRCxvQ0FBYSxHQUFiLFVBQWMsSUFBcUIsRUFBRSxDQUFTLEVBQUUsQ0FBUzs7UUFDdkQsSUFBSSxPQUFPLElBQUksSUFBSSxRQUFRLEVBQUU7WUFDM0IsSUFBSSxHQUFHLElBQUksTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQ3pCO1FBQ0QsYUFBTyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsMENBQUUsYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO0lBQ3RELENBQUM7SUFtQkQsOEJBQU8sR0FBUCxVQUE2QixDQUFJO1FBQy9CLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxDQUFDLElBQUksS0FBSyxNQUFNLEVBQUU7WUFDckIsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFFLENBQXFCLENBQUMsQ0FBQztTQUNqRDtRQUNELElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQU8sRUFBRSxDQUFDO1FBQzVCLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFpQixDQUFDO0lBQ3JDLENBQUM7SUFDTyxrQ0FBVyxHQUFuQixVQUFvQixDQUFPOztRQUN6QixJQUFJLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvQixJQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDLEdBQUcsQ0FBQyxXQUFXLE9BQUMsQ0FBQyxDQUFDLElBQUksbUNBQUksRUFBRSxDQUFDLENBQUM7UUFDeEQsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxFQUFFLENBQUM7UUFDNUIsT0FBTyxHQUFHLENBQUM7SUFDYixDQUFDO0lBQ0gsbUJBQUM7QUFBRCxDQUFDLEFBdkNELElBdUNDO0FBdkNZLG9DQUFZO0FBd0NaLFFBQUEsWUFBWSxHQUFHLElBQUksWUFBWSxFQUFFLENBQUMifQ==