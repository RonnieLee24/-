Object.defineProperty(exports, "__esModule", { value: true });
exports.canvasRenderer = exports.CanvasRenderer = void 0;
var Recourse_1 = require("./Recourse");
var Ani_1 = require("./ani/Ani");
var canvas_1 = require("canvas");
var CanvasRenderer = /** @class */ (function () {
    function CanvasRenderer(canvas) {
        if (canvas)
            this.setCanvas(canvas);
    }
    CanvasRenderer.prototype.getImageData = function () {
        return this.canvas.toDataURL("image/png", 0.99);
    };
    CanvasRenderer.prototype.getImageBuffer = function () {
        if (this.canvas instanceof canvas_1.Canvas) {
            return this.canvas.toBuffer("image/jpeg");
        }
        else {
            throw new Error("image buffer only be supported in node.js");
        }
    };
    CanvasRenderer.prototype.clean = function () {
        this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    };
    CanvasRenderer.prototype.setCanvas = function (canvas) {
        this.canvas = canvas;
        this.ctx = this.canvas.getContext("2d");
    };
    CanvasRenderer.prototype.render = function (child, offset) {
        var _this = this;
        if (offset === void 0) { offset = 0; }
        if (!child)
            return;
        offset += child.offsetSec;
        var sec = this.stage.sec;
        var comp;
        if (child instanceof Ani_1.Ani) {
            comp = child === null || child === void 0 ? void 0 : child.getComponent(sec - offset);
        }
        else {
            comp = child;
        }
        if (!comp)
            return;
        this.ctx.save();
        // render special component props
        if (this.ctx.globalAlpha > 0) {
            // render itself
            // render base component props
            this.renderBase(comp);
            switch (comp.type) {
                case "Text":
                    this.renderText(comp);
                    break;
                case "Rect":
                    this.renderRect(comp);
                    break;
                case "Image":
                    this.renderImage(comp);
                    break;
                case "Arc":
                    this.renderArc(comp);
                    break;
                case "Line":
                    this.renderPath(comp);
                    break;
            }
            // render children components
            comp.children.forEach(function (c) {
                if (c)
                    _this.render(c, offset);
            });
        }
        this.ctx.restore();
    };
    CanvasRenderer.prototype.renderArc = function (arc) {
        this.ctx.beginPath();
        this.ctx.arc(0, 0, arc.radius, arc.startAngle, arc.endAngle, arc.anticlockwise);
        if (arc.strokeStyle)
            this.ctx.stroke();
        if (arc.fillStyle)
            this.ctx.fill();
    };
    CanvasRenderer.prototype.renderPath = function (line) {
        if (!line.path) {
            return;
        }
        var path;
        if (typeof line.path === "string") {
            path = new Path2D(line.path);
        }
        else {
            path = line.path;
        }
        if (this.ctx.fillStyle)
            this.ctx.fill(path);
        if (this.ctx.strokeStyle)
            this.ctx.stroke(path);
    };
    CanvasRenderer.prototype.renderClipRect = function (component) {
        this.ctx.beginPath();
        this.radiusArea(0, 0, component.shape.width, component.shape.height, component.radius);
        this.ctx.clip();
        this.ctx.closePath();
    };
    CanvasRenderer.prototype.renderImage = function (image) {
        var src = Recourse_1.recourse.images.get(image.src);
        if (!src) {
            return;
        }
        if (image.sliceShape) {
            this.ctx.drawImage(image, image.slicePosition.x, image.slicePosition.y, image.sliceShape.width, image.sliceShape.height, 0, 0, image.shape.width, image.shape.height);
        }
        else if (image.shape) {
            this.ctx.drawImage(src, 0, 0, image.shape.width, image.shape.height);
        }
        else {
            this.ctx.drawImage(src, 0, 0);
        }
    };
    CanvasRenderer.prototype.renderRect = function (component) {
        if (component.clip) {
            this.renderClipRect(component);
        }
        if (!component.radius || component.radius <= 0) {
            this.ctx.fillRect(0, 0, component.shape.width, component.shape.height);
        }
        else {
            this.fillRadiusRect(0, 0, component.shape.width, component.shape.height, component.radius);
        }
        if (component.strokeStyle) {
            if (!component.radius || component.radius <= 0) {
                this.ctx.strokeRect(0, 0, component.shape.width, component.shape.height);
            }
            else {
                this.strokeRadiusRect(0, 0, component.shape.width, component.shape.height, component.radius);
            }
        }
    };
    CanvasRenderer.prototype.renderBase = function (component) {
        var _a, _b, _c, _d, _e;
        var position;
        if (!component.position) {
            if (component.type === "Text") {
                position = {
                    x: this.canvas.width / 2,
                    y: this.canvas.height / 2,
                };
            }
            else {
                position = {
                    x: 0,
                    y: 0,
                };
            }
        }
        else {
            position = component.position;
        }
        this.ctx.translate(position.x - component.center.x, position.y - component.center.y);
        if (component.filter) {
            this.ctx.filter = component.filter;
        }
        if (component.strokeStyle) {
            this.ctx.strokeStyle = component.strokeStyle;
        }
        if (component.fillStyle) {
            this.ctx.fillStyle = component.fillStyle;
        }
        if (component.lineWidth) {
            this.ctx.lineWidth = component.lineWidth;
        }
        if (component.alpha !== undefined) {
            this.ctx.globalAlpha *= component.alpha;
        }
        if (component.scale !== undefined) {
            this.ctx.scale(component.scale.x, component.scale.y);
        }
        if ((_a = component.shadow) === null || _a === void 0 ? void 0 : _a.enable) {
            this.ctx.shadowBlur = (_c = (_b = component.shadow) === null || _b === void 0 ? void 0 : _b.blur) !== null && _c !== void 0 ? _c : 10;
            this.ctx.shadowColor = (_e = (_d = component.shadow) === null || _d === void 0 ? void 0 : _d.color) !== null && _e !== void 0 ? _e : "#000";
        }
    };
    CanvasRenderer.prototype.renderText = function (component) {
        this.prerenderText(component);
        if (component.strokeStyle) {
            this.ctx.strokeText(component.text, 0, 0);
        }
        if (component.fillStyle) {
            this.ctx.fillText(component.text, 0, 0);
        }
    };
    CanvasRenderer.prototype.prerenderText = function (component) {
        if (component.textAlign) {
            this.ctx.textAlign = component.textAlign;
        }
        if (component.textBaseline) {
            this.ctx.textBaseline = component.textBaseline;
        }
        var fontStr = (component.fontStyle ? component.fontStyle : "") + " " + (component.fontVariant ? component.fontVariant : "") + " " + (component.fontWeight ? component.fontWeight : "") + " " + (component.fontSize ? component.fontSize : 16) + "px " + (component.font ? component.font : "");
        if (component.font ||
            component.fontSize ||
            component.fontWeight ||
            component.fontStyle ||
            component.fontVariant) {
            this.ctx.font = fontStr;
        }
    };
    CanvasRenderer.prototype.fillRadiusRect = function (left, top, w, h, r) {
        this.ctx.beginPath();
        this.radiusArea(left, top, w, h, r);
        this.ctx.closePath();
        this.ctx.fill();
    };
    CanvasRenderer.prototype.strokeRadiusRect = function (left, top, w, h, r) {
        this.ctx.beginPath();
        this.radiusArea(left, top, w, h, r);
        this.ctx.closePath();
        this.ctx.stroke();
    };
    CanvasRenderer.prototype.radiusArea = function (left, top, w, h, r) {
        this.ctx.lineWidth = 0;
        var pi = Math.PI;
        this.ctx.arc(left + r, top + r, r, -pi, -pi / 2);
        this.ctx.arc(left + w - r, top + r, r, -pi / 2, 0);
        this.ctx.arc(left + w - r, top + h - r, r, 0, pi / 2);
        this.ctx.arc(left + r, top + h - r, r, pi / 2, pi);
    };
    return CanvasRenderer;
}());
exports.CanvasRenderer = CanvasRenderer;
exports.canvasRenderer = new CanvasRenderer();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQ2FudmFzUmVuZGVyZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvY29yZS9DYW52YXNSZW5kZXJlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUlBLHVDQUFzQztBQUd0QyxpQ0FBZ0M7QUFHaEMsaUNBQWdDO0FBRWhDO0lBY0Usd0JBQVksTUFBbUM7UUFDN0MsSUFBSSxNQUFNO1lBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNyQyxDQUFDO0lBZkQscUNBQVksR0FBWjtRQUNFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFDRCx1Q0FBYyxHQUFkO1FBQ0UsSUFBSSxJQUFJLENBQUMsTUFBTSxZQUFZLGVBQU0sRUFBRTtZQUNqQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxDQUFDO1NBQzNDO2FBQU07WUFDTCxNQUFNLElBQUksS0FBSyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7U0FDOUQ7SUFDSCxDQUFDO0lBT0QsOEJBQUssR0FBTDtRQUNFLElBQUksQ0FBQyxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNsRSxDQUFDO0lBQ0Qsa0NBQVMsR0FBVCxVQUFVLE1BQWtDO1FBQzFDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFFLENBQUM7SUFDM0MsQ0FBQztJQUNELCtCQUFNLEdBQU4sVUFBTyxLQUE2QixFQUFFLE1BQWtCO1FBQXhELGlCQXdDQztRQXhDcUMsdUJBQUEsRUFBQSxVQUFrQjtRQUN0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